from pathlib import Path
import webbrowser

IMG_NAME = "IMG_5874.jpg"
TITLE = "月面でのロボット心臓試験に成功 ― 現在も評価を継続中"
SUB = "医療科学と宇宙探査の両分野における画期的な成果"
FNAME = "university_news.html"

base_paras = [
    "医療科学と宇宙探査の交差点において、本プロジェクトは心臓ケアの未来像を再定義する可能性を示した。これまでの地上試験では再現できなかった極限条件において、医療機器がどの程度の性能と信頼性を維持できるかを検証することは、今後の臨床応用に向けて重要なステップである。",
    "今回の月面試験では、低重力環境に最適化された拍動制御アルゴリズムが初めて適用された。このアルゴリズムは、リアルタイムでの血流データ解析と予測モデルに基づき、拍動リズムやポンプ圧を自動調整する仕組みを持つ。その結果、ポンプ効率は地上試験時と同等以上の数値を記録し、流量の安定性も高い相関が確認された。",
    "さらに、微小重力下では体液分布や血圧の変動が顕著になることが知られているが、今回の試験ではそうした環境変化に対しても制御システムが安定動作を維持できることが証明された。これにより、長期間の宇宙滞在中における循環器系治療の可能性が大きく広がったといえる。",
    "材料工学の観点では、耐放射線性ポリマーと高強度金属複合材によるハウジング構造が採用され、月面特有の温度変化（−170℃から120℃までの急激な変化）にも寸法安定性を維持することが確認された。また、密封性と耐疲労特性は、過去の地上耐久試験の基準を上回る結果を示した。",
    "エネルギーマネジメントシステムにはモジュール化されたバッテリーパックと冗長化電源経路が搭載され、異常時には自動的にセーフモードへ移行する設計が実装されている。これにより、突発的な電力損失や部品故障時でも最低限の機能を維持することが可能となった。",
    "生体適合性試験では、血液接触面に施された特殊な表面改質処理が血栓形成リスクを低減する効果を示した。今後は長期循環シミュレーションおよび実際の動物モデルを用いた検証が予定されており、臨床応用に向けた最終段階に入る見込みである。",
    "今回の成果は、国際的な宇宙医療研究機関との連携のもとで実現したものであり、地上での医療機器開発においても新たな技術革新をもたらす可能性を秘めている。特に、極限環境における医療機器の性能保証は、災害医療や僻地医療などにも応用できる分野である。",
    "研究チームは今後、人工知能による自動診断機能や遠隔制御システムの統合を目指しており、宇宙飛行士や長期ミッション 乗組員の健康管理を次世代レベルへと引き上げる計画だとしている。"
]

long_body = "\n".join(f"<p>{p}</p>" for p in base_paras)

html = f"""<!doctype html>
<html lang="ja"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>{TITLE}</title>
<style>
:root{{--max:980px;--ink:#0b1220}}
*{{box-sizing:border-box;margin:0;padding:0}}
body{{font:15px/1.7 -apple-system,system-ui,Segoe UI,Roboto,sans-serif;color:var(--ink);background:#f5f7fb}}
.wrap{{max-width:var(--max);margin:28px auto;padding:0 16px}}
.headline{{font-size:28px;margin-bottom:6px}}
.sub{{color:#555;margin-bottom:18px}}
.content{{display:grid;grid-template-columns:1.1fr .9fr;gap:22px;align-items:start}}
.article{{background:#fff;padding:18px;border-radius:12px;box-shadow:0 6px 24px rgba(0,0,0,.06)}}
.article p{{margin:0 0 12px}}
.thumb{{background:#fff;border-radius:12px;box-shadow:0 6px 24px rgba(0,0,0,.06);overflow:hidden}}
.thumb img{{display:block;width:100%;height:auto;max-height:620px;object-fit:cover}}
.thumb figcaption{{font-size:12px;color:#666;padding:8px 10px;background:#f2f4f8}}
@media (max-width:800px){{.content{{grid-template-columns:1fr}}}}
</style>
</head>
<body>
<div class="wrap">
  <h1 class="headline">{TITLE}</h1>
  <p class="sub">{SUB}</p>
  <section class="content">
    <article class="article">{long_body}</article>
    <figure class="thumb">
      <img src="{IMG_NAME}" alt="Robotic Heart thumbnail">
      <figcaption>Figure 1. 月面でのロボット心臓試験のサムネイル</figcaption>
    </figure>
  </section>
</div>
</body>
</html>"""

Path(FNAME).write_text(html, encoding="utf-8")
webbrowser.open(Path(FNAME).resolve().as_uri())
